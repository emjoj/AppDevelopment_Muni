// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

datasource db {
  provider = "postgresql"

url      = "postgresql://postgres:admin@localhost:5432/postgres?schema=public"
//url      = env("DATABASE_URL") 
}


generator client {
  provider = "prisma-client-js"
}


model User {
  id            Int                     @id @default(autoincrement())
  firstName     String
  lastName      String
  messages      Message[]
  user1         Contact[]               @relation("user1") 
  user2         Contact[]               @relation("user2") 
  conversations ConversationUser[]
}

model Contact {
  id               Int              @id @default(autoincrement())
  user1             User            @relation("user1", fields: [user1Id], references: [id])
  user1Id           Int
  user2             User            @relation("user2", fields: [user2Id], references: [id])
  user2Id           Int
  state             String
}

model Conversation {
id          Int                   @id @default(autoincrement())
isActive    Boolean               @default(false)
isPinned    Boolean               @default(false)
users       ConversationUser[]
messages    Message[]

}

model ConversationUser {
id                  Int               @id @default(autoincrement())
conversation        Conversation      @relation(fields: [conversationId], references: [id])
conversationId      Int
user                User              @relation(fields: [userId], references: [id])
userId              Int

}

model Message {
  id              Int             @id @default(autoincrement())
  senderId        Int
  sender          User            @relation(fields: [senderId], references: [id])
  content         String?
  createdAt       DateTime        @default(now())
  conversationId  Int?
  conversation    Conversation?   @relation(fields: [conversationId], references: [id])

}






